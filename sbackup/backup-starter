#!/bin/sh
#
# SBackup - rendszer
#
# Lokális gép mentése
#

d=`dirname $0`
. $d/backup-config

cd $BINDIR

d=`date`
echo "$d Mentés elkezdése." >> $LOGDIR/$LOGFILE

# log rotáció
if [ $ENABLE_LOG = 1 ]; then
		d=`date`
		./backup-log 2>/dev/null
		echo "$d Log rotáció." >> $LOGDIR/$LOGFILE
fi

# napi mentés rotáció
if [ $ENABLE_DAYROTATE = 1 ]; then
		d=`date`
		echo "$d Napi mentés rotáció." >> $LOGDIR/$LOGFILE
		./backup-dayrotate 2>/dev/null
fi

# helyi gép
if [ $ENABLE_SYSTEM = 1 ]; then
		d=`date`
		echo "$d Helyi gép mentése." >> $LOGDIR/$LOGFILE
		./backup-system 2>/dev/null
fi

# egyéb WEB forrás
if [ $ENABLE_WEBDL = 1 ]; then
		d=`date`
		echo "$d Távoli gép weboldalról mentése." >> $LOGDIR/$LOGFILE
		./backup-webdl 2>/dev/null
fi

# levelezés
if [ $ENABLE_MAIL = 1 ]; then
		d=`date`
		echo "$d Levelezés könyvtárainak mentése." >> $LOGDIR/$LOGFILE
		./backup-mail 2>/dev/null
fi

# sql
if [ $ENABLE_SQL = 1 ]; then
		d=`date`
		echo "$d SQL adatbázisok mentése." >> $LOGDIR/$LOGFILE
		./backup-sql 2>>/dev/null
fi

# mentés felhőbe, adathordozóra
if [ $ENABLE_USB = 1 ]; then
		d=`date`
		echo "$d Mentés USB adathordozóra." >> $LOGDIR/$LOGFILE
		./backup-usb-mount 2>/dev/null
fi

if [ $ENABLE_RCLONE = 1 ]; then
		d=`date`
		echo "$d Mentés felhőbe." >> $LOGDIR/$LOGFILE
		./backup-rclone 2>/dev/null
fi

# mentés hálózati meghajtóra
if [ $ENABLE_NETWORK = 1 ]; then
		d=`date`
		echo "$d Mentés hálózati meghajtóra." >> $LOGDIR/$LOGFILE
		./backup-net-copy 2>/dev/null
fi

# mentés web könyvtárba
if [ $ENABLE_WEBDIR = 1 ]; then
		d=`date`
		echo "$d Mentés web könyvtárba." >> $LOGDIR/$LOGFILE
		./backup-webdir 2>/dev/null
fi

d=`date`
echo "$d Kész." >> $LOGDIR/$LOGFILE

cd $TPATH

#
